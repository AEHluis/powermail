function PowermailBackend(e){"use strict";this.initialize=function(){t(),a(),n(),o(),l(),s(),d(),r(),c(),f(),u(),p(),v(),h(),m()};var t=function(){e(".powermail_listbe_details_container").hide(),e(".openPowermailDetails").click(function(){var i=e(this),t=i.closest("tr").children(":first").children(":first");t.hasClass("fa")?t.toggleClass("fa-caret-right").toggleClass("fa-caret-down"):t.toggleClass("t3-icon-irre-collapsed").toggleClass("t3-icon-irre-expanded"),i.closest("tr").next().toggleClass("powermail_listbe_details_closed").find(".powermail_listbe_details_container").slideToggle()})},a=function(){e(document).on("click",".unhideMail, .hideMail",function(){var i=e(this),t=i.closest("td").find(".container_module_uri").val(),a=i.closest("td").find(".container_uid").val(),n=i.closest("td").find(".container_table").val(),o=_(i.closest("tr"));g(n,a,o,t)})},n=function(){e(document).on("click",".deleteMail",function(){var i=e(this),t=i.closest("td").find(".container_module_uri").val(),a=i.closest("td").find(".container_uid").val(),n=i.closest("td").find(".container_table").val(),o=i.closest("td").find(".container_label_delete_confirmation").val();confirm(o)&&(C(i.closest("tr")),w(n,a,t))})},o=function(){e(".f3-widget-paginator a").click(function(t){var a=e(this).prop("href"),n=a.split("&");for(i=0;i<n.length;i++)if(-1!==n[i].indexOf("widget"))var o=n[i];if(void 0!=o){var l=o.split("=");l[0]=l[0].replace("%40","@");var s='<input type="hidden" name="'+l[0]+'" value="'+l[1]+'" />';e(".hiddenvalues").append(decodeURI(s)),e("#powermail_module_search").submit()}t.preventDefault()})},l=function(){e("a.sorting").click(function(t){t.preventDefault();var a=e(this).prop("href"),n=a.split("&");for(i=0;i<n.length;i++)if(-1!==n[i].indexOf("sorting"))var o=n[i];if(void 0!=o){var l=o.split("=");l[0]=l[0].replace("%40","@");var s=e('.extended_export_sorting_container[name="'+decodeURI(l[0])+'"]');s.length&&s.remove();var d='<input type="hidden" name="'+l[0]+'" value="'+l[1]+'" />';e(".hiddenvalues").append(decodeURI(d)),e("#powermail_module_search").submit()}})},s=function(){e(".addPowermailSelection").click(function(){b(e(this)),x()})},d=function(){e(".addPowermailSelectionAll").click(function(){e(".addPowermailSelection").each(function(){b(e(this))}),x()})},r=function(){e(".powermailSelectionDelete").click(function(){k()})},c=function(){e(".powermailSelectionHide").click(function(){y(e)})},f=function(){e("#extended_search input, #extended_search select").not('*[type="submit"]').each(function(){return""!==e(this).val()?void e("#extended_search").addClass("in"):void 0})},u=function(){e(".powermail_date").each(function(){var i=e(this),t=!0,a=!0;"date"===i.data("datepicker-settings")?a=!1:"time"===i.data("datepicker-settings")&&(t=!1),i.datetimepicker({format:i.data("datepicker-format"),timepicker:a,datepicker:t,lang:"en",i18n:{en:{months:i.data("datepicker-months").split(","),dayOfWeek:i.data("datepicker-days").split(",")}}})})},p=function(){e(".export_icon_xls, .export_icon_csv").click(function(){e(this).hasClass("export_icon_csv")&&e("#forwardToAction").val("exportCsv"),e(this).hasClass("export_icon_xls")&&e("#forwardToAction").val("exportXls"),e(this).closest("form").submit()}),e('*[data-action="searchall_submit"]').click(function(){e("#forwardToAction").val("list")}),e(".extended_export_title").click(function(){var i=e(this);i.hasClass("powermail-close")?(i.removeClass("powermail-close").addClass("powermail-open").children("span").removeClass("t3-icon-move-down").addClass("t3-icon-move-up"),i.next().slideDown("",function(){i.next().children("div").children("div").fadeTo("slow",1)})):(i.removeClass("powermail-open").addClass("powermail-close").children("span").removeClass("t3-icon-move-up").addClass("t3-icon-move-down"),i.next().children("div").children("div").fadeTo("slow",0,function(){i.next().slideUp()}))}),e(function(){e(".extended_export_field, .extended_export_field_container").sortable({connectWith:".connected",update:function(i,t){var a=e(this).prop("id");if("export_field_selection"===a){var n=e(this).sortable("toArray").toString();e("#export_fields").val(n)}}}).disableSelection()})},v=function(){e(".openHiddenTable").click(function(){var i=e(this).closest("tr");i.find(".dots").toggle(),i.find(".hiddenConverterTable").toggle()})},h=function(){e(".powermail_listbe_details_dd.powermail_listbe_details_type_password").html("********")},m=function(){var i=e(".powermail_reporting_form_fields_table");i.find("tr:even").addClass("even"),i.find("tr:first").removeClass("even"),i.find("tr").hide(),i.find("tr:first").show(),i.find("th").click(function(){var i=e(this);i.hasClass("powermail-close")?i.removeClass("powermail-close").addClass("powermail-open"):i.removeClass("powermail-open").addClass("powermail-close"),i.parent().siblings().slideToggle("fast")}),e('*[data-flot-active="1"]').each(function(){for(var i=e(this),t=[],a=M(i.data("flot-data-values"),","),n=M(i.data("flot-data-labels"),","),o=M(i.data("flot-data-colors"),","),l=0;l<a.length;l++){var s={data:a[l],label:n[l],color:o[l]};t.push(s)}e.plot(i,t,{series:{pie:{show:!0,innerRadius:.5,radius:1,opacity:.3,color:"#FF0000",label:{show:!0,radius:1,formatter:L,background:{opacity:.8}},combine:{color:"#999",threshold:.1}}},grid:{hoverable:!0,clickable:!0}}),i.bind("plothover",function(i,t,a){if(a){var n=parseFloat(a.series.percent).toFixed(2);e("#hover").html("<span style='font-weight:bold; color:"+a.series.color+"'>"+a.series.label+" ("+n+"%)</span>")}}),i.bind("plotclick",function(e,i,t){if(t){var a=parseFloat(t.series.percent).toFixed(2);alert(""+t.series.label+": "+a+"%")}})})},_=function(e){var i=e.find(".visibilityButton"),t=1;return i.hasClass("unhideMail")?(i.removeClass("t3-icon-edit-hide").removeClass("unhideMail").removeClass("fa-toggle-on").addClass("t3-icon-edit-unhide").addClass("hideMail").addClass("fa-toggle-off"),e.find(".t3-icon-tcarecords-tx_powermail_domain_model_mail").addClass("transparent")):(i.removeClass("t3-icon-edit-unhide").removeClass("hideMail").removeClass("fa-toggle-off").addClass("t3-icon-edit-hide").addClass("unhideMail").addClass("fa-toggle-on"),e.find(".t3-icon-tcarecords-tx_powermail_domain_model_mail").removeClass("transparent"),t=0),t},g=function(i,t,a,n){var o=n+"&data["+i+"]["+t+"][hidden]="+a+"&redirect="+T3_THIS_LOCATION;e.ajax({url:o})},w=function(i,t,a){var n=a+"&cmd["+i+"]["+t+"][delete]=1&redirect="+T3_THIS_LOCATION;e.ajax({url:n})},C=function(e){e.fadeOut("slow",function(){e.next().remove(),e.remove()})},b=function(e){e.hasClass("fa")?e.toggleClass("fa-plus").toggleClass("fa-minus").closest("tr").toggleClass("selectLine"):e.toggleClass("t3-icon-view-table-expand").toggleClass("t3-icon-view-table-collapse").closest("tr").toggleClass("selectLine")},x=function(){var i=e(".selectLine").length;e(".selectedLineMessage_numbers").html(i),i>0?e(".selectedLineMessage").show():e(".selectedLineMessage").hide()},k=function(){e(".selectLine").each(function(){var i=e(this),t=i.children(":last"),a=t.find(".container_module_uri").val(),n=t.find(".container_uid").val(),o=t.find(".container_table").val();w(o,n,a),C(i),T(i)}),x()},T=function(e){var i=e.find(".addPowermailSelection");b(i)},y=function(){e(".selectLine").each(function(){var i=e(this),t=i.children(":last"),a=t.find(".container_module_uri").val(),n=t.find(".container_uid").val(),o=t.find(".container_table").val();g(o,n,_(i),a),T(i)}),x()},M=function(e,i){if(-1!==e.toString().indexOf(i))var t=e.split(i);else t=[e];return t},L=function(e,i){return'<div class="flotLabel">'+e+"<br/>"+Math.round(i.percent)+"%</div>"};window.PowermailBackend=PowermailBackend}jQuery(document).ready(function(e){var i=new window.PowermailBackend(e);i.initialize()});